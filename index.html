<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™®é€šé›†é‹é‹è²»æŸ¥è©¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f9f9f9;
        }
        .form-container {
            max-width: 700px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-container input, .form-container button {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .form-container button {
            background-color: #28a745;
            color: white;
            border: none;
            cursor: pointer;
        }
        .form-container button:hover {
            background-color: #218838;
        }
        .result {
            margin-top: 20px;
            font-size: 18px;
            color: #333;
            padding: 15px;
            border-radius: 8px;
            background-color: #f1f1f1;
            display: none;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        .info {
            font-size: 14px;
            color: #555;
            margin-top: 15px;
        }
    </style>
</head>
<body>

<div class="form-container">
    <h2>ğŸ“¦ æ™®é€šé›†é‹é‹è²»æŸ¥è©¢</h2>
    <p>è«‹è¼¸å…¥åŒ…è£¹å°ºå¯¸ï¼ˆé•·Ã—å¯¬Ã—é«˜ï¼‰åŠé‡é‡ï¼ˆå…¬æ–¤ï¼‰ï¼Œç³»çµ±è‡ªå‹•è¨ˆç®—é‹è²»</p>

    <label>é•· (cm)ï¼š</label>
    <input type="number" id="length" placeholder="è¼¸å…¥é•·åº¦">
    <label>å¯¬ (cm)ï¼š</label>
    <input type="number" id="width" placeholder="è¼¸å…¥å¯¬åº¦">
    <label>é«˜ (cm)ï¼š</label>
    <input type="number" id="height" placeholder="è¼¸å…¥é«˜åº¦">
    
    <label>é‡é‡ (kg)ï¼š</label>
    <input type="number" id="weight" placeholder="è¼¸å…¥å…¬æ–¤æ•¸" min="0.5" step="0.5">

    <h3>ğŸ“ æ¾³æ´²å¢ƒå…§é…é€</h3>
    <p>è«‹è¼¸å…¥æ‚¨çš„ **éƒµéå€è™Ÿ** (å¿…å¡«) ä¾†æŸ¥è©¢æœ¬åœ°é…é€é‹è²»ï¼š</p>
    <input type="text" id="zipcode" placeholder="è¼¸å…¥éƒµéå€è™Ÿ">
    <button onclick="calculateShipping()">æŸ¥è©¢é‹è²»</button>

    <div class="result" id="result"></div>

    <!-- ğŸš€ é‡è¦èªªæ˜å€å¡Š -->
    <div class="info">
        <h3>ğŸ“Œ è²»ç”¨è¨ˆç®—æ–¹å¼ï¼š</h3>
        <ul>
            <li>å°ç£åˆ°æ¾³æ´²é‹è²»ï¼šåŒ…è£¹çš„é‡é‡å’Œæç©é‡é‡ï¼ˆé•·Ã—å¯¬Ã—é«˜ Ã· 5000ï¼‰å–è¼ƒå¤§å€¼ã€‚</li>
            <li>æ¾³æ´²é…é€è²»ï¼šæ ¹æ“šéƒµéå€è™ŸæŸ¥è©¢ç•¶åœ°é…é€è²»ã€‚</li>
            <li>åŠ å€¼æœå‹™è²»ï¼ˆå¦‚æœ‰ï¼‰ï¼šä¾‹å¦‚æ‹ç…§é©—è²¨ã€åŠ å›ºåŒ…è£ç­‰é¡å¤–éœ€æ±‚ã€‚</li>
        </ul>
        <p><strong>ç¸½è²»ç”¨ = å°ç£ç©ºé‹è²» (AUD) + æ¾³æ´²é…é€è²» (AUD) + åŠ å€¼æœå‹™è²»</strong></p>

        <h3>ğŸš¨ é‡è¦æé†’ï¼š</h3>
        <ul>
            <li>è‹¥å–®ä¸€åŒ…è£¹é‡é‡æˆ–æç©æ›ç®—å¾Œè¶…é 20 å…¬æ–¤ï¼Œè«‹è¯ç¹«å®¢æœã€‚</li>
            <li>æ™®é€šé›†é‹ èˆªç­ä¸€å€‹æœˆä¸€æ¬¡ (6-12 å€‹å·¥ä½œæ—¥åˆ°é”)ã€‚</li>
            <li>åƒ…æ”¯æŒæ•´æ•¸æˆ– 0.5 å…¬æ–¤å–®ä½ï¼Œå…¶ä»–æ•¸å­—æœƒè‡ªå‹•é€²ä½ã€‚</li>
        </ul>
    </div>
</div>

<script>
    let shippingRatesData = {};
    let destinationShippingZonesData = [];

    // ğŸ“Œ é‹è²» JSON ä½ç½®
    const shippingRatesUrl = "https://raw.githubusercontent.com/ROYYUMMYLIU/Norshipping/refs/heads/main/new_shipping_rates.json";
    
    // ğŸ“Œ æ¾³æ´²å¢ƒå…§é‹è²» JSON ä½ç½® (ä»¥ AUD è¨ˆåƒ¹)
    const destinationShippingZonesUrl = "https://raw.githubusercontent.com/ROYYUMMYLIU/Norshipping/refs/heads/main/destination_shipping_fees_with_zones.json";

    // è®€å– æ™®é€šé›†é‹é‹è²»æ•¸æ“š
    fetch(shippingRatesUrl)
        .then(response => response.json())
        .then(data => {
            shippingRatesData = data;
        })
        .catch(error => {
            console.error("âŒ ç„¡æ³•è¼‰å…¥æ™®é€šé›†é‹é‹è²»æ•¸æ“š:", error);
        });

    // è®€å– æ¾³æ´²æœ¬åœ°é…é€é‹è²»æ•¸æ“š
    fetch(destinationShippingZonesUrl)
        .then(response => response.json())
        .then(data => {
            destinationShippingZonesData = data;
        })
        .catch(error => {
            console.error("âŒ ç„¡æ³•è¼‰å…¥æ¾³æ´²é‹è²»æ•¸æ“š:", error);
        });

    function roundUp(weight) {
        return Math.ceil(weight * 2) / 2;
    }

    function calculateShipping() {
        const length = parseFloat(document.getElementById("length").value) || 0;
        const width = parseFloat(document.getElementById("width").value) || 0;
        const height = parseFloat(document.getElementById("height").value) || 0;
        const weight = parseFloat(document.getElementById("weight").value) || 0;
        const zipcode = document.getElementById("zipcode").value.trim();

        if (!zipcode) {
            document.getElementById("result").innerHTML = "<p class='error'>âš ï¸ è«‹è¼¸å…¥éƒµéå€è™Ÿï¼</p>";
            document.getElementById("result").style.display = "block";
            return;
        }

        let volumeWeight = (length * width * height) / 5000;
        let finalWeight = roundUp(Math.max(volumeWeight, weight));

        if (finalWeight > 20) {
            document.getElementById("result").innerHTML = "<p class='error'>âš ï¸ è¶…å‡º 20 å…¬æ–¤ï¼Œè«‹è¯ç¹«å®¢æœï¼</p>";
            document.getElementById("result").style.display = "block";
            return;
        }

        let shippingCost = shippingRatesData[finalWeight] ? shippingRatesData[finalWeight].AUD : 0;
        let australiaCost = 0;

        for (let region of destinationShippingZonesData) {
            let postalRanges = region["åœ°å€"].split(",").map(r => r.trim());
            for (let range of postalRanges) {
                let [start, end] = range.includes("-") ? range.split("-").map(Number) : [parseInt(range), parseInt(range)];
                if (zipcode >= start && zipcode <= end) {
                    australiaCost = region["é‹è²»_AUD"];
                    break;
                }
            }
        }

        document.getElementById("result").innerHTML = `
            <p>ğŸ’° æ™®é€šé›†é‹é‹è²» (AUD)ï¼š${shippingCost.toFixed(2)}</p>
            <p>ğŸšš æ¾³æ´²é…é€è²» (AUD)ï¼š${australiaCost.toFixed(2)}</p>
            <p>ğŸ”¹ <strong>ç¸½è²»ç”¨ (AUD)ï¼š${(shippingCost + australiaCost).toFixed(2)}</strong></p>
        `;
        document.getElementById("result").style.display = "block";
    }
</script>

</body>
</html>
